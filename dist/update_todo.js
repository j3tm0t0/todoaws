// Generated by CoffeeScript 1.10.0
var AWS, docClient;

AWS = require('aws-sdk');

docClient = new AWS.DynamoDB.DocumentClient();

exports.handler = function(event, context) {
  var param;
  if (event.todoId) {
    param = {
      TableName: 'todos',
      Key: {
        todoId: event.todoId
      }
    };
  } else {
    return context.fail("todoId is not specified");
  }
  docClient.get(param, function(err, data) {
    var item, key, value;
    if (err) {
      return context.fail(err);
    } else if (data.Item) {
      item = data.Item;
      for (key in event) {
        value = event[key];
        item[key] = value;
      }
      param = {
        TableName: 'todos',
        Item: item
      };
      docClient.put(param, function(err, data) {
        if (err) {
          return context.fail(err);
        } else {
          return context.succeed(item);
        }
      });
    } else {
      return context.fail("item not found");
    }
  });
};
