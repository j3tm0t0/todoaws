// Generated by CoffeeScript 1.10.0
var AWS, docClient;

AWS = require('aws-sdk');

docClient = new AWS.DynamoDB.DocumentClient();

exports.handler = function(event, context) {
  var item, param, uuid;
  if (event.todoId) {
    return context.fail("todoId cannot not be specified");
  } else {
    uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      var r, v;
      r = Math.random() * 16 | 0;
      v = c === 'x' ? r : r & 0x3 | 0x8;
      return v.toString(16);
    });
    item = event;
    item.todoId = uuid;
    item.createdAt = Math.floor(new Date / 1000);
    item.finishedAt = 0;
    param = {
      TableName: 'todos',
      Item: item
    };
  }
  docClient.put(param, function(err, data) {
    if (err) {
      return context.fail(err);
    } else {
      return context.succeed(item);
    }
  });
};
